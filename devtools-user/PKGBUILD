# Maintainer: Dictator Mei <dctxmei@gmail.com>
pkgname=devtools-user
pkgver=20180821
pkgrel=1
pkgdesc="Tools for Arch Linux Dictator Repository package maintainers"
arch=('any')
url="https://gitlab.com/dctxmei/devtools-user"
license=('GPL')
depends=('devtools')
makedepends=("cmake" "git")
source=("git+${url}.git")
sha512sums=('SKIP')

build() {
    cd $pkgname
    mkdir -p build
    cd build
    cmake .. -DCMAKE_INSTALL_PREFIX=/usr
    make
}

package() {
    cd $pkgname/build/cmds
    sed -e \
        's/\/usr\/share\/devtools\/pacman-\${repo}.conf/\/etc\/pacman.conf/' \
        -e 's/\/usr\/share\/devtools\/makepkg-\${arch}.conf/\/etc\/makepkg.conf/' \
        user-x86_64-build -i
    install -Dm755 user-x86_64-build "$pkgdir"/usr/bin/user-x86_64-build
}
